# [CVE-2024-40090](https://www.cve.org/CVERecord?id=CVE-2024-40090): Info Leak in Boa Webserver
* **CVSS Score** - 4.3, Medium ([CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N))
* **Overview** - the custom TCP service running on port 5432 has several functions, one of which includes spinning up a webserver stored at `/hualai/boa/boa` on port 8023. Since this service has no authentication, anyone can spin up the webserver. This server has a programming bug where uninitialized memory is placed into a buffer sent back to the user, leaking the memory location of both the stack and the uClibc library.
* **Description**
    * When any path requested by the user contains the string `html`, a simple HTTP response is given containing a link with the name of a logfile. A buffer is allocated for the HTTP response and filled in with content. However, the first line is `sprintf(body,"%s\t<center><a href =\"%s\">\"%s\"</a></center>\r\n",body,logdir_name,logdir_name);`, which keeps the memory already present in the `body` buffer since `body` is referenced in the middle. This buffer is never cleared, meaning memory from previous stack frames is still present. It just so happens that addresses in both the stack memory section and uClibc memory section are present before any null byte, meaning those addresses are returned to the user.
    * These memory addresses, while not of much use on their own, can provide key information used to weaponize a buffer overflow in the same system. In addition, because the Boa webserver is forked, the addresses it leaks are the same for each incoming HTTP request.
* **Steps to Reproduce**
    * The command `curl https://192.168.58.1:8023/ -k | xxd` will show the hexdump of requesting the main page. Notice the first 8 bytes are 2x 32-bit addresses.
* **Impact** - Anyone on the LAN can leak the stack and library memory segment addresses.